import{d as _,g as U,a as w,v as B,_ as C,c as m,b as e,t as S,o as g,r,x as p,w as y,e as v,G as M,$ as D,q as E,y as V,A as j}from"./index-bpNO_8uP.js";import{S as P,a as W}from"./SectionHeader-C4vtWxD-.js";import{S as i}from"./sweetalert2.esm.all-DzlfzZPw.js";import{C as k}from"./CardPhotoUploader-D4nm50iS.js";const R=_({emits:["edit","refresh"],props:["blog"],methods:{async deleteBlog(){await U().then(async o=>{var t;(o==null?void 0:o.role)==1?i.fire({title:"Confirmation",text:"Delete "+((t=this.blog)==null?void 0:t.title)+"?",icon:"question",showCancelButton:!0,confirmButtonText:"Delete"}).then(async a=>{var l;a.isConfirmed&&await w.get(B().api_main+"blog/delete?dataid="+((l=this.blog)==null?void 0:l.dataid)).then(async d=>{var c,n,s;(c=d.data)!=null&&c.success?i.fire({title:"Success",text:(n=d.data)==null?void 0:n.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):i.fire({title:"Warning",text:(s=d.data)==null?void 0:s.message,icon:"warning"})})}):i.fire({title:"Action denied",text:"Only administrator level has permission to delete",icon:"error"})})},editModal(o){this.$emit("edit",{data:o})}}}),q={class:"card my-4"},x=["src"],A={class:"card-body"},H={class:"text-primary"},I={class:"p-0 m-0"},T={class:"blog-description mt-4"},G={class:"d-flex justify-content-end align-items-center"};function N(o,t,a,l,d,c){var n,s,f,u,b;return g(),m("div",q,[e("img",{class:"blog-cover-photo w-100 bg-dark",src:(n=o.blog)!=null&&n.photo?(s=o.blog)==null?void 0:s.fullpath:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRK9aVGeIwDc_9na_hcvbjcH4oqbm-nWiMs-g&s"},null,8,x),e("div",A,[e("h3",H,S((f=o.blog)==null?void 0:f.title),1),e("div",null,[t[2]||(t[2]=e("h6",{class:"p-0 m-0 fw-bold"},"Date Posted:",-1)),e("p",I,[e("small",null,S((u=o.blog)==null?void 0:u.created_at),1)])]),e("p",T,S((b=o.blog)==null?void 0:b.description),1),e("div",G,[e("button",{class:"btn btn-primary w-50 me-3",onClick:t[0]||(t[0]=h=>o.editModal(o.blog))},"Edit"),e("button",{class:"btn btn-danger w-50",onClick:t[1]||(t[1]=h=>o.deleteBlog())},"Delete")])])])}const O=C(R,[["render",N],["__scopeId","data-v-8be3bf75"]]),L=_({emits:["refresh","closed"],props:{open:{default:!1,type:Boolean}},components:{CardPhotoUploader:k},data(){return{form:{title:"",description:"",photo:"",status:1}}},methods:{closeModal(){this.$emit("closed")},onUploadSuccess(o){var t;this.form.photo=(t=o==null?void 0:o.data)==null?void 0:t.filepath},onUploadFail(o){i.fire({title:"Warning",text:"Fail to upload photo, try again later.",icon:"warning"})},async saveBlog(){await w.get(B().api_main+"blog/create?"+$.param(this.form)).then(async o=>{var t,a,l;(t=o.data)!=null&&t.success?i.fire({title:"Success",text:(a=o.data)==null?void 0:a.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):i.fire({title:"Warning",text:(l=o.data)==null?void 0:l.message,icon:"warning"})})}}}),z={class:"modal-dialog",role:"document"},K={class:"modal-content"},J={class:"modal-body",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},Q={class:"form-group mt-3"},X={class:"form-group mt-4"},Y={class:"modal-footer"};function Z(o,t,a,l,d,c){const n=p("CardPhotoUploader");return g(),m("div",{class:M(["modal fade",{show:o.open,display:o.open}]),tabindex:"-1",role:"dialog"},[e("div",z,[e("div",K,[t[6]||(t[6]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Booking Details")],-1)),e("div",J,[r(n,{onUploaded:o.onUploadSuccess,onFail:o.onUploadFail},null,8,["onUploaded","onFail"]),e("div",Q,[t[4]||(t[4]=e("label",null,"Title",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.form.title=s),type:"text",class:"form-control form-control-lg"},null,512),[[v,o.form.title]])]),e("div",X,[t[5]||(t[5]=e("label",null,"Description",-1)),y(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.form.description=s),class:"form-control form-control-lg"},null,512),[[v,o.form.description]])])]),e("div",Y,[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",onClick:t[2]||(t[2]=s=>o.closeModal())},"Close"),e("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=s=>o.saveBlog())},"Save")])])])],2)}const oo=C(L,[["render",Z],["__scopeId","data-v-c3c018eb"]]),to=_({props:{open:{default:!1,type:Boolean},blog:{default:{},type:Object}},components:{CardPhotoUploader:k},data(){return{}},methods:{closeModal(){this.$emit("closed")},async saveBlog(){await w.get(B().api_main+"blog/update?"+D.param(this.blog)).then(async o=>{var t,a,l;(t=o.data)!=null&&t.success?i.fire({title:"Success",text:(a=o.data)==null?void 0:a.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):i.fire({title:"Warning",text:(l=o.data)==null?void 0:l.message,icon:"warning"})})},onUploadSuccess(o){var t;this.blog.photo=(t=o==null?void 0:o.data)==null?void 0:t.filepath},onUploadFail(o){i.fire({title:"Warning",text:"Fail to replace photo, try again later.",icon:"warning"})}}}),eo={class:"modal-dialog",role:"document"},so={class:"modal-content"},lo={class:"modal-body",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},ao={class:"form-group mt-3"},no={class:"form-group mt-4"},io={class:"modal-footer"};function ro(o,t,a,l,d,c){const n=p("CardPhotoUploader");return g(),m("div",{class:M(["modal fade",{show:o.open,display:o.open}]),tabindex:"-1",role:"dialog"},[e("div",eo,[e("div",so,[t[6]||(t[6]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"Update Blog")],-1)),t[7]||(t[7]=e("hr",null,null,-1)),e("div",lo,[r(n,{onUploaded:o.onUploadSuccess,onFail:o.onUploadFail,btn_upload_text:"Replace",instruction:"Select photo with png, jpg, jpeg file extensions for blog photo replacement."},null,8,["onUploaded","onFail"]),e("div",ao,[t[4]||(t[4]=e("label",null,"Title",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.blog.title=s),type:"text",class:"form-control form-control-lg"},null,512),[[v,o.blog.title]])]),e("div",no,[t[5]||(t[5]=e("label",null,"Description",-1)),y(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.blog.description=s),class:"form-control form-control-lg",style:{"min-height":"250px"}},null,512),[[v,o.blog.description]])])]),e("div",io,[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",onClick:t[2]||(t[2]=s=>o.closeModal())},"Close"),e("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=s=>o.saveBlog())},"Save")])])])],2)}const po=C(to,[["render",ro],["__scopeId","data-v-b2ea554f"]]),co=_({components:{ModalEditBlog:po,ModalCreateBlog:oo,CardBlog:O,SectionSidebar:W,SectionHeader:P},data(){return{admin:{},modal:{create_blog_open:!1,update_blog_open:!1,update_blog_info:{}},blogs:{}}},methods:{async fetchBlogs(){await w.get(B().api_main+"blog/fetchAll").then(async o=>{this.blogs=o.data})},openEditModal(o){this.modal.update_blog_open=!0,this.modal.update_blog_info=o.data}},async mounted(){await U().then(async o=>{o?(this.admin=o,await this.fetchBlogs().then(async()=>{console.log("Blogs:",E(this.$data))})):this.$router.replace("/")})}}),mo={class:"layout-wrapper layout-content-navbar"},go={class:"layout-container"},fo={class:"layout-page"},uo={class:"content-wrapper"},bo={class:"container-xxl flex-grow-1 container-p-y"},ho={class:"d-flex justify-content-between align-items-center py-3"},$o={class:"d-flex"},yo={class:"row"};function vo(o,t,a,l,d,c){const n=p("SectionSidebar"),s=p("SectionHeader"),f=p("CardBlog"),u=p("ModalCreateBlog"),b=p("ModalEditBlog");return g(),m("div",mo,[e("div",go,[r(n),e("div",fo,[r(s,{onOpen_notif:t[0]||(t[0]=()=>{o.$emit("open_notif")})}),e("div",uo,[e("div",bo,[e("div",ho,[t[7]||(t[7]=e("h4",{class:"fw-bold"},"Manage Blog",-1)),e("div",$o,[t[6]||(t[6]=e("input",{type:"text",class:"form-control me-3",placeholder:"Search"},null,-1)),e("button",{class:"btn btn-primary",style:{width:"180px"},onClick:t[1]||(t[1]=()=>{o.modal.create_blog_open=!0})},"Create Blog")])]),e("div",yo,[(g(!0),m(V,null,j(o.blogs,(h,F)=>(g(),m("div",{class:"col-sm-12 col-md-6 col-lg-4",key:F},[r(f,{blog:h,onEdit:o.openEditModal,onRefresh:t[2]||(t[2]=_o=>o.fetchBlogs())},null,8,["blog","onEdit"])]))),128))])])])])]),r(u,{open:o.modal.create_blog_open,onClosed:t[3]||(t[3]=()=>{o.modal.create_blog_open=!1}),onRefresh:t[4]||(t[4]=h=>o.fetchBlogs())},null,8,["open"]),r(b,{open:o.modal.update_blog_open,blog:o.modal.update_blog_info,onClosed:t[5]||(t[5]=()=>{o.modal.update_blog_open=!1})},null,8,["open","blog"])])}const Uo=C(co,[["render",vo]]);export{Uo as default};
