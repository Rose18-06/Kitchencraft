import{d as b,g as V,a as w,v as $,_ as y,c as d,b as n,y as C,A as S,o as p,t as _,w as m,e as f,$ as k,r,x as u,K as T,C as P,D as B,E as v}from"./index-bpNO_8uP.js";import{S as O,a as R}from"./SectionHeader-C4vtWxD-.js";import{S as c}from"./sweetalert2.esm.all-DzlfzZPw.js";import{C as A}from"./CardPhotoUploader-D4nm50iS.js";const W=b({emits:["view","update","refresh"],props:{menus:{default:{},type:Object}},methods:{onView(e){this.$emit("view",e)},onUpdate(e){this.$emit("update",e)},async onDelete(e){await V().then(async t=>{(t==null?void 0:t.role)==1?c.fire({title:"Confirmation",text:"Delete "+(e==null?void 0:e.name)+"?",icon:"question",showCancelButton:!0,confirmButtonText:"Delete"}).then(async i=>{i.isConfirmed&&await w.get($().api_main+"menu/delete?dataid="+(e==null?void 0:e.dataid)).then(async a=>{var h,g,s;(h=a.data)!=null&&h.success?c.fire({title:"Success",text:(g=a.data)==null?void 0:g.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):c.fire({title:"Warning",text:(s=a.data)==null?void 0:s.message,icon:"warning"})})}):c.fire({title:"Action denied",text:"Only administrator level has permission to delete",icon:"error"})})}}}),H={class:"card"},N={class:"table-responsive text-nowrap",style:{height:"600px"}},E={class:"table"},L=["onClick"],q=["onClick"],K=["onClick"];function z(e,t,i,a,h,g){return p(),d("div",H,[t[1]||(t[1]=n("h5",{class:"card-header"},"Manage Menu",-1)),n("div",N,[n("table",E,[t[0]||(t[0]=n("thead",null,[n("tr",null,[n("th",{style:{width:"50px"}},"No."),n("th",null,"Menu"),n("th",{style:{width:"100px"}},"View"),n("th",{style:{width:"100px"}},"Update"),n("th",{style:{width:"100px"}},"Delete")])],-1)),n("tbody",null,[(p(!0),d(C,null,S(e.menus,(s,o)=>(p(),d("tr",{key:o},[n("td",null,_(o+1),1),n("td",null,_(s==null?void 0:s.name),1),n("td",null,[n("button",{class:"btn btn-primary btn-sm",onClick:l=>e.onView(s)},"View",8,L)]),n("td",null,[n("button",{class:"btn btn-primary btn-sm",onClick:l=>e.onUpdate(s)},"Update",8,q)]),n("td",null,[n("button",{class:"btn btn-danger btn-sm",onClick:l=>e.onDelete(s)},"Delete",8,K)])]))),128))])])])])}const G=y(W,[["render",z]]),I=b({props:{menu:{default:{},type:Object}}}),J={class:"card"},Q=["src"],X={class:"card-body"},Y={class:"form-group mt-4"},Z={class:"form-group mt-4"};function ee(e,t,i,a,h,g){var s,o;return p(),d("div",J,[t[4]||(t[4]=n("h5",{class:"card-header"},"View Menu",-1)),n("img",{class:"w-100",src:(s=e.menu)!=null&&s.photo?"https://api-fileserver.jlipreso.com/"+((o=e.menu)==null?void 0:o.photo):"https://www.menuprice.app/assets/img/nn.png"},null,8,Q),n("div",X,[n("div",Y,[t[2]||(t[2]=n("label",null,"Menu name",-1)),m(n("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>e.menu.name=l),type:"text",class:"form-control form-control-lg bg-white",readonly:""},null,512),[[f,e.menu.name]])]),n("div",Z,[t[3]||(t[3]=n("label",null,"Description",-1)),m(n("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>e.menu.description=l),class:"form-control form-control-lg bg-white",style:{"min-height":"150px"},readonly:""},null,512),[[f,e.menu.description]])])])])}const te=y(I,[["render",ee]]),ne=b({emits:["refresh"],components:{CardPhotoUploader:A},data(){return{form:{name:"",category:"",description:"",package:"",photo:"",status:1},menu_categories:{}}},methods:{onUploadSuccess(e){var t;this.form.photo=(t=e==null?void 0:e.data)==null?void 0:t.filepath},onUploadFail(){c.fire({title:"Warning",text:"Fail to upload photo, try again later.",icon:"warning"})},async fethMenuCategories(){await w.get($().api_main+"menu_categories/fetchAll").then(async e=>{this.menu_categories=e.data})},async saveMenu(){await w.get($().api_main+"menu/add?"+k.param(this.form)).then(async e=>{var t,i,a;(t=e.data)!=null&&t.success?c.fire({title:"Success",text:(i=e.data)==null?void 0:i.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):c.fire({title:"Warning",text:(a=e.data)==null?void 0:a.message,icon:"warning"})})}}}),oe={class:"card"},se={class:"card-body"},ae={class:"form-group"},ie={class:"form-group mt-2"},le=["value"],re={class:"form-group mt-2"},de={class:"form-group mt-2"},pe={class:"d-flex justify-content-end mt-4"};function ue(e,t,i,a,h,g){const s=u("CardPhotoUploader");return p(),d("div",null,[n("div",oe,[t[10]||(t[10]=n("h5",{class:"card-header"},"Add menu",-1)),r(s,{onUploaded:e.onUploadSuccess,onFail:e.onUploadFail,btn_upload_text:"Replace",instruction:"Select photo with png, jpg, jpeg file extensions for menu photo replacement."},null,8,["onUploaded","onFail"]),n("div",se,[n("div",ae,[t[5]||(t[5]=n("label",null,"Menu name",-1)),m(n("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.form.name=o),type:"text",class:"form-control form-control-lg"},null,512),[[f,e.form.name]])]),n("div",ie,[t[7]||(t[7]=n("label",null,"Category",-1)),m(n("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.form.category=o),class:"form-control form-control-lg"},[t[6]||(t[6]=n("option",{value:"0"},"Select Category",-1)),(p(!0),d(C,null,S(e.menu_categories,(o,l)=>(p(),d("option",{key:l,value:o==null?void 0:o.name},_(o==null?void 0:o.name),9,le))),128))],512),[[T,e.form.category]])]),n("div",re,[t[8]||(t[8]=n("label",null,"Description",-1)),m(n("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.description=o),class:"form-control form-control-lg",style:{"min-height":"60px"}},null,512),[[f,e.form.description]])]),n("div",de,[t[9]||(t[9]=n("label",null,"Package",-1)),m(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.package=o),class:"form-control form-control-lg",style:{"min-height":"60px"}},null,512),[[f,e.form.package]])]),n("div",pe,[n("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=o=>e.saveMenu())},"Save Menu")])])])])}const me=y(ne,[["render",ue]]),ce=b({emits:["refresh"],props:{menu:{default:{},type:Object}},components:{CardPhotoUploader:A},data(){return{menu_categories:{}}},methods:{onUploadSuccess(e){var t;this.menu.photo=(t=e==null?void 0:e.data)==null?void 0:t.filepath},onUploadFail(){c.fire({title:"Warning",text:"Fail to upload photo, try again later.",icon:"warning"})},async updateMenu(){await w.get($().api_main+"menu/update?"+k.param(this.menu)).then(async e=>{var t,i,a;(t=e.data)!=null&&t.success?c.fire({title:"Success",text:(i=e.data)==null?void 0:i.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):c.fire({title:"Warning",text:(a=e.data)==null?void 0:a.message,icon:"warning"})})},async fethMenuCategories(){await w.get($().api_main+"menu_categories/fetchAll").then(async e=>{this.menu_categories=e.data})}},async mounted(){await this.fethMenuCategories()}}),fe={class:"card mt-4"},he={class:"card-body"},ge={class:"form-group"},we={class:"form-group mt-4"},$e=["value"],be={class:"form-group mt-4"},ye={class:"form-group mt-4"},ve={class:"d-flex justify-content-end mt-4"};function _e(e,t,i,a,h,g){const s=u("CardPhotoUploader");return p(),d("div",null,[n("div",fe,[t[10]||(t[10]=n("h5",{class:"card-header"},"Update Menu",-1)),r(s,{onUploaded:e.onUploadSuccess,onFail:e.onUploadFail,btn_upload_text:"Replace",instruction:"Select photo with png, jpg, jpeg file extensions for menu photo replacement."},null,8,["onUploaded","onFail"]),n("div",he,[n("div",ge,[t[5]||(t[5]=n("label",null,"Menu name",-1)),m(n("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.menu.name=o),type:"text",class:"form-control form-control-lg"},null,512),[[f,e.menu.name]])]),n("div",we,[t[7]||(t[7]=n("label",null,"Category",-1)),m(n("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.menu.category=o),class:"form-control form-control-lg"},[t[6]||(t[6]=n("option",{value:"0"},"Select Category",-1)),(p(!0),d(C,null,S(e.menu_categories,(o,l)=>(p(),d("option",{key:l,value:o==null?void 0:o.name},_(o==null?void 0:o.name),9,$e))),128))],512),[[T,e.menu.category]])]),n("div",be,[t[8]||(t[8]=n("label",null,"Description",-1)),m(n("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.menu.description=o),class:"form-control form-control-lg",style:{"min-height":"150px"}},null,512),[[f,e.menu.description]])]),n("div",ye,[t[9]||(t[9]=n("label",null,"Package",-1)),m(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>e.menu.package=o),class:"form-control form-control-lg",style:{"min-height":"150px"}},null,512),[[f,e.menu.package]])]),n("div",ve,[n("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=o=>e.updateMenu())},"Update Menu")])])])])}const Ue=y(ce,[["render",_e]]),Me=b({components:{CardMenuView:te,Swiper:B,SwiperSlide:P,CardMenuUpdate:Ue,CardMenuAdd:me,TableMenus:G,SectionSidebar:R,SectionHeader:O},data(){return{admin:{},swiper:{},menus:{},menu_form:{}}},methods:{onSwiper(e){this.swiper=e},swipeToView(e){this.menu_form=e,this.swiper.slideTo(0)},swipeToUpdate(e){this.menu_form=e,this.swiper.slideTo(2)},swipeToAdd(){this.swiper.slideTo(1)},async fetchMenus(){await w.get($().api_main+"menu/fetchAll").then(async e=>{this.menus=e.data})}},async mounted(){await V().then(async e=>{e?(this.admin=e,await this.fetchMenus()):this.$router.replace("/")})}}),Ce={class:"layout-wrapper layout-content-navbar"},Se={class:"layout-container"},Ve={class:"layout-page"},ke={class:"content-wrapper"},Te={class:"container-xxl flex-grow-1 container-p-y"},Ae={class:"d-flex justify-content-between align-items-center py-0"},De={class:"d-flex"},je={class:"row"},Fe={class:"col-sm-12 col-md-5"},xe={class:"col-sm-12 col-md-7"};function Pe(e,t,i,a,h,g){const s=u("SectionSidebar"),o=u("SectionHeader"),l=u("CardMenuView"),U=u("swiper-slide"),D=u("CardMenuAdd"),j=u("CardMenuUpdate"),F=u("swiper"),x=u("TableMenus");return p(),d("div",Ce,[n("div",Se,[r(s),n("div",Ve,[r(o,{onOpen_notif:t[0]||(t[0]=()=>{e.$emit("open_notif")})}),n("div",ke,[n("div",Te,[n("div",Ae,[t[5]||(t[5]=n("h4",{class:"fw-bold py-3"},"Manage Menu",-1)),n("div",De,[n("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=M=>e.swipeToAdd())},"Add Menu")])]),n("div",je,[n("div",Fe,[r(F,{"slides-per-view":1,"space-between":50,onSwiper:e.onSwiper},{default:v(()=>[r(U,{class:"swiper-no-swiping"},{default:v(()=>[r(l,{menu:e.menu_form},null,8,["menu"])]),_:1}),r(U,{class:"swiper-no-swiping"},{default:v(()=>[r(D,{onRefresh:t[2]||(t[2]=M=>e.fetchMenus())})]),_:1}),r(U,{class:"swiper-no-swiping"},{default:v(()=>[r(j,{menu:e.menu_form,onRefresh:t[3]||(t[3]=M=>e.fetchMenus())},null,8,["menu"])]),_:1})]),_:1},8,["onSwiper"])]),n("div",xe,[r(x,{menus:e.menus,onView:e.swipeToView,onUpdate:e.swipeToUpdate,onRefresh:t[4]||(t[4]=M=>e.fetchMenus())},null,8,["menus","onView","onUpdate"])])])])])])])])}const He=y(Me,[["render",Pe]]);export{He as default};
