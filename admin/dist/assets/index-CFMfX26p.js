import{d as C,_ as M,c as v,b as o,G as k,o as b,a as _,v as U,$ as S,r as c,x as p,w as a,e as d,g as D,q as O,y as P,A,t as h}from"./index-bpNO_8uP.js";import{t as V}from"./formatter-Cd5PYes5.js";import{S as B,a as N}from"./SectionHeader-C4vtWxD-.js";import{S as m}from"./sweetalert2.esm.all-DzlfzZPw.js";import{C as F}from"./CardPhotoUploader-D4nm50iS.js";const W=C({emits:["closed","refresh"],props:{open:{default:!1,type:Boolean},event:{default:{},type:Object}},data(){return{}},methods:{closeModal(){this.$emit("closed")},toCurrencyFormat(t){return V(t)}}}),j={class:"modal-dialog",role:"document"},R={class:"modal-content"},H=["src"],I={class:"modal-body bg-light-gray",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},q={class:"card"},L={class:"card-body"},T={class:"mb-3"},z=["value"],G={class:"mb-3"},x=["value"],J={class:"mb-3"},K=["value"],Q={class:"row"},X={class:"col-sm-12 col-md-6"},Y={class:"mb-3"},Z=["value"],oo={class:"col-sm-12 col-md-6"},eo={class:"mb-3"},to=["value"],so={class:"mb-3"},lo=["value"],no={class:"modal-footer"};function ao(t,e,i,n,u,f){var r,s,g,$,w,l,y;return b(),v("div",{class:k(["modal fade",{show:t.open,display:t.open}]),tabindex:"-1",role:"dialog"},[o("div",j,[o("div",R,[e[7]||(e[7]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Event Details")],-1)),o("img",{class:"w-100",src:"https://api-fileserver.jlipreso.com/"+((r=t.event)==null?void 0:r.photo)},null,8,H),o("div",I,[o("div",q,[o("div",L,[o("div",T,[e[1]||(e[1]=o("label",{class:"form-label"},"Event Name",-1)),o("input",{value:(s=t.event)==null?void 0:s.name,type:"text",class:"form-control form-control-lg bg-white",readonly:""},null,8,z)]),o("div",G,[e[2]||(e[2]=o("label",{class:"form-label"},"Description",-1)),o("textarea",{value:(g=t.event)==null?void 0:g.description,class:"form-control form-control-lg bg-white",style:{"min-height":"150px"},readonly:""},null,8,x)]),o("div",J,[e[3]||(e[3]=o("label",{class:"form-label"},"Package",-1)),o("textarea",{value:($=t.event)==null?void 0:$.package,class:"form-control form-control-lg bg-white",style:{"min-height":"150px"},readonly:""},null,8,K)]),o("div",Q,[o("div",X,[o("div",Y,[e[4]||(e[4]=o("label",{class:"form-label"},"Min. Occupancy",-1)),o("input",{value:(w=t.event)==null?void 0:w.min_occupancy,type:"number",class:"form-control form-control-lg bg-white",readonly:""},null,8,Z)])]),o("div",oo,[o("div",eo,[e[5]||(e[5]=o("label",{class:"form-label"},"Max. Occupancy",-1)),o("input",{value:(l=t.event)==null?void 0:l.max_occupancy,type:"number",class:"form-control form-control-lg bg-white",readonly:""},null,8,to)])])]),o("div",so,[e[6]||(e[6]=o("label",{class:"form-label"},"Price per pax",-1)),o("input",{value:t.toCurrencyFormat((y=t.event)==null?void 0:y.price),type:"text",class:"form-control form-control-lg bg-white",readonly:""},null,8,lo)])])])]),o("div",no,[o("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",onClick:e[0]||(e[0]=E=>t.closeModal())},"Close")])])])],2)}const io=M(W,[["render",ao],["__scopeId","data-v-5b8aeeeb"]]),ro=C({emits:["closed","refresh"],props:{open:{default:!1,type:Boolean},event:{default:{},type:Object}},components:{CardPhotoUploader:F},data(){return{loading:!1}},methods:{closeModal(){this.$emit("closed")},async updateEvent(){await _.get(U().api_main+"events/update?"+S.param(this.event)).then(async t=>{var e,i,n;(e=t.data)!=null&&e.success?m.fire({title:"Success",text:(i=t.data)==null?void 0:i.message,icon:"success"}).then(async()=>{this.$emit("refresh")}):m.fire({title:"Warning",text:(n=t.data)==null?void 0:n.message,icon:"warning"})})},onUploadSuccess(t){var e;this.event.photo=(e=t==null?void 0:t.data)==null?void 0:e.filepath},onUploadFail(t){m.fire({title:"Warning",text:"Fail to upload photo, try again later.",icon:"warning"})}}}),mo={class:"modal-dialog",role:"document"},co={class:"modal-content"},po={class:"modal-body bg-light-gray",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},uo={class:"card"},fo={class:"card-body"},vo={class:"mb-3"},bo={class:"mb-3"},yo={class:"mb-3"},ho={class:"row"},go={class:"col-sm-12 col-md-6"},$o={class:"mb-3"},wo={class:"col-sm-12 col-md-6"},_o={class:"mb-3"},Uo={class:"mb-3"},Co={class:"modal-footer"},Mo=["disabled"],Eo=["disabled"];function ko(t,e,i,n,u,f){const r=p("CardPhotoUploader");return b(),v("div",{class:k(["modal fade",{show:t.open,display:t.open}]),tabindex:"-1",role:"dialog"},[o("div",mo,[o("div",co,[e[14]||(e[14]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Update Event")],-1)),c(r,{onUploaded:t.onUploadSuccess,onFail:t.onUploadFail},null,8,["onUploaded","onFail"]),o("div",po,[o("div",uo,[o("div",fo,[o("div",vo,[e[8]||(e[8]=o("label",{class:"form-label"},"Event Name",-1)),a(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.event.name=s),type:"text",class:"form-control form-control-lg"},null,512),[[d,t.event.name]])]),o("div",bo,[e[9]||(e[9]=o("label",{class:"form-label"},"Description",-1)),a(o("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.event.description=s),class:"form-control form-control-lg",style:{"min-height":"150px"}},null,512),[[d,t.event.description]])]),o("div",yo,[e[10]||(e[10]=o("label",{class:"form-label"},"Package",-1)),a(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>t.event.package=s),class:"form-control form-control-lg",style:{"min-height":"150px"}},null,512),[[d,t.event.package]])]),o("div",ho,[o("div",go,[o("div",$o,[e[11]||(e[11]=o("label",{class:"form-label"},"Min. Occupancy",-1)),a(o("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>t.event.min_occupancy=s),type:"number",class:"form-control form-control-lg"},null,512),[[d,t.event.min_occupancy]])])]),o("div",wo,[o("div",_o,[e[12]||(e[12]=o("label",{class:"form-label"},"Max. Occupancy",-1)),a(o("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>t.event.max_occupancy=s),type:"number",class:"form-control form-control-lg"},null,512),[[d,t.event.max_occupancy]])])])]),o("div",Uo,[e[13]||(e[13]=o("label",{class:"form-label"},"Price per pax",-1)),a(o("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>t.event.price=s),type:"number",class:"form-control form-control-lg"},null,512),[[d,t.event.price]])])])])]),o("div",Co,[o("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>t.closeModal()),disabled:t.loading},"Close",8,Mo),o("button",{class:"btn btn-primary",onClick:e[7]||(e[7]=s=>t.updateEvent()),disabled:t.loading},"Update",8,Eo)])])])],2)}const So=M(ro,[["render",ko],["__scopeId","data-v-7ce7a4e4"]]),Vo=C({emits:["closed","refresh"],props:{open:{default:!1,type:Boolean}},components:{CardPhotoUploader:F},data(){return{loading:!1,form:{name:"",description:"",package:"",min_occupancy:0,max_occupancy:0,price:0,photo:""}}},methods:{closeModal(){this.$emit("closed")},onUploadSuccess(t){var e;this.form.photo=(e=t==null?void 0:t.data)==null?void 0:e.filepath},onUploadFail(t){m.fire({title:"Warning",text:"Fail to upload photo, try again later.",icon:"warning"})},async saveEvent(){this.loading=!0,await _.get(U().api_main+"events/add?"+S.param(this.form)).then(async t=>{var e,i,n;this.loading=!1,(e=t.data)!=null&&e.success?m.fire({title:"Success",text:(i=t.data)==null?void 0:i.message,icon:"success"}).then(async()=>{this.form.name="",this.form.description="",this.form.package="",this.form.min_occupancy=0,this.form.max_occupancy=0,this.form.price=0,this.$emit("refresh")}):m.fire({title:"Warning",text:(n=t.data)==null?void 0:n.message,icon:"warning"})})}}}),Fo={class:"modal-dialog",role:"document"},Do={class:"modal-content"},Oo={class:"modal-body bg-light-gray",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},Po={class:"card"},Ao={class:"card-body"},Bo={class:"mb-3"},No={class:"mb-3"},Wo={class:"mb-3"},jo={class:"row"},Ro={class:"col-sm-12 col-md-6"},Ho={class:"mb-3"},Io={class:"col-sm-12 col-md-6"},qo={class:"mb-3"},Lo={class:"mb-3"},To={class:"modal-footer"},zo=["disabled"],Go=["disabled"];function xo(t,e,i,n,u,f){const r=p("CardPhotoUploader");return b(),v("div",{class:k(["modal fade",{show:t.open,display:t.open}]),tabindex:"-1",role:"dialog"},[o("div",Fo,[o("div",Do,[e[14]||(e[14]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Add Event")],-1)),c(r,{onUploaded:t.onUploadSuccess,onFail:t.onUploadFail},null,8,["onUploaded","onFail"]),o("div",Oo,[o("div",Po,[o("div",Ao,[o("div",Bo,[e[8]||(e[8]=o("label",{class:"form-label"},"Event Name",-1)),a(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.form.name=s),type:"text",class:"form-control form-control-lg"},null,512),[[d,t.form.name]])]),o("div",No,[e[9]||(e[9]=o("label",{class:"form-label"},"Description",-1)),a(o("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.form.description=s),class:"form-control form-control-lg"},null,512),[[d,t.form.description]])]),o("div",Wo,[e[10]||(e[10]=o("label",{class:"form-label"},"Package",-1)),a(o("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>t.form.package=s),class:"form-control form-control-lg"},null,512),[[d,t.form.package]])]),o("div",jo,[o("div",Ro,[o("div",Ho,[e[11]||(e[11]=o("label",{class:"form-label"},"Min. Occupancy",-1)),a(o("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>t.form.min_occupancy=s),type:"number",class:"form-control form-control-lg"},null,512),[[d,t.form.min_occupancy]])])]),o("div",Io,[o("div",qo,[e[12]||(e[12]=o("label",{class:"form-label"},"Max. Occupancy",-1)),a(o("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>t.form.max_occupancy=s),type:"number",class:"form-control form-control-lg"},null,512),[[d,t.form.max_occupancy]])])])]),o("div",Lo,[e[13]||(e[13]=o("label",{class:"form-label"},"Price per pax",-1)),a(o("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>t.form.price=s),type:"number",class:"form-control form-control-lg"},null,512),[[d,t.form.price]])])])])]),o("div",To,[o("button",{class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>t.closeModal()),disabled:t.loading},"Close",8,zo),o("button",{class:"btn btn-primary",onClick:e[7]||(e[7]=s=>t.saveEvent()),disabled:t.loading},"Save",8,Go)])])])],2)}const Jo=M(Vo,[["render",xo],["__scopeId","data-v-5df0f5b3"]]),Ko=C({components:{ModalEventAdd:Jo,ModalEventUpdate:So,ModalEventView:io,SectionSidebar:N,SectionHeader:B},data(){return{admin:{},events:{},modal:{view:{open:!1,event:{}},update:{open:!1,event:{}},add:{open:!1}}}},methods:{toCurrencyFormat(t){return V(t)},onModalView(t){this.modal.view.event=t,this.modal.view.open=!0},onModalUpdate(t){this.modal.update.event=t,this.modal.update.open=!0},onModalDelete(t){var e;((e=this.admin)==null?void 0:e.role)==1?m.fire({title:"Confirmation",text:"Delete "+(t==null?void 0:t.name)+"?",showCancelButton:!0,confirmButtonText:"Delete",icon:"question"}).then(async i=>{i.isConfirmed&&await _.get(U().api_main+"events/delete?dataid="+(t==null?void 0:t.dataid)).then(async n=>{var u,f,r;(u=n.data)!=null&&u.success?m.fire({title:"Success",text:(f=n.data)==null?void 0:f.message,icon:"success"}).then(async()=>{await this.fetchEvents()}):m.fire({title:"Warning",text:(r=n.data)==null?void 0:r.message,icon:"warning"})})}):m.fire({title:"Action denied",text:"Only administrator level has permission to delete",icon:"error"})},async fetchEvents(){await _.get(U().api_main+"events/fetchAll").then(async t=>{this.events=t.data})}},async mounted(){await D().then(async t=>{t?(this.admin=t,await this.fetchEvents().then(async()=>{console.log("Events:",O(this.$data))})):this.$router.replace("/")})}}),Qo={class:"layout-wrapper layout-content-navbar"},Xo={class:"layout-container"},Yo={class:"layout-page"},Zo={class:"content-wrapper"},oe={class:"container-xxl flex-grow-1 container-p-y"},ee={class:"d-flex justify-content-between align-items-center py-3"},te={class:"d-flex"},se={class:"card"},le={class:"table-responsive text-nowrap"},ne={class:"table"},ae={class:"table-border-bottom-0"},de=["onClick"],ie=["onClick"],re=["onClick"];function me(t,e,i,n,u,f){const r=p("SectionSidebar"),s=p("SectionHeader"),g=p("ModalEventView"),$=p("ModalEventUpdate"),w=p("ModalEventAdd");return b(),v("div",Qo,[o("div",Xo,[c(r),o("div",Yo,[c(s,{onOpen_notif:e[0]||(e[0]=()=>{t.$emit("open_notif")})}),o("div",Zo,[o("div",oe,[o("div",ee,[e[8]||(e[8]=o("h4",{class:"fw-bold"},"Manage Events",-1)),o("div",te,[o("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=()=>{t.modal.add.open=!0})},"Add Event")])]),o("div",se,[e[10]||(e[10]=o("h5",{class:"card-header"},"Manage Events",-1)),o("div",le,[o("table",ne,[e[9]||(e[9]=o("thead",null,[o("tr",null,[o("th",null,"No."),o("th",null,"Event"),o("th",null,"Price/pax"),o("th",null,"Min. Occ."),o("th",null,"Max. Occ."),o("th",{style:{width:"100px"}},"View"),o("th",{style:{width:"100px"}},"Update"),o("th",{style:{width:"100px"}},"Delete")])],-1)),o("tbody",ae,[(b(!0),v(P,null,A(t.events,(l,y)=>(b(),v("tr",{key:y},[o("td",null,h(y+1),1),o("td",null,h(l==null?void 0:l.name),1),o("td",null,h(t.toCurrencyFormat(l==null?void 0:l.price)),1),o("td",null,h(l==null?void 0:l.min_occupancy),1),o("td",null,h(l==null?void 0:l.max_occupancy),1),o("td",null,[o("button",{class:"btn btn-primary btn-sm",onClick:E=>t.onModalView(l)},"View",8,de)]),o("td",null,[o("button",{class:"btn btn-primary btn-sm",onClick:E=>t.onModalUpdate(l)},"Update",8,ie)]),o("td",null,[o("button",{class:"btn btn-danger btn-sm",onClick:E=>t.onModalDelete(l)},"Delete",8,re)])]))),128))])])])])])])])]),c(g,{open:t.modal.view.open,event:t.modal.view.event,onClosed:e[2]||(e[2]=()=>{t.modal.view.open=!1}),onRefresh:e[3]||(e[3]=l=>t.fetchEvents())},null,8,["open","event"]),c($,{open:t.modal.update.open,event:t.modal.update.event,onClosed:e[4]||(e[4]=()=>{t.modal.update.open=!1}),onRefresh:e[5]||(e[5]=l=>t.fetchEvents())},null,8,["open","event"]),c(w,{open:t.modal.add.open,onClosed:e[6]||(e[6]=()=>{t.modal.add.open=!1}),onRefresh:e[7]||(e[7]=l=>t.fetchEvents())},null,8,["open"])])}const be=M(Ko,[["render",me]]);export{be as default};
