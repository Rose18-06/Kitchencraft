import{d as $,M as _,_ as h,c as u,b as o,w as l,e as a,G as C,o as p,X as S,g as U,Y as V,Z as D,r as f,x as b,I as E,y as F,A as M,t as y}from"./index-bpNO_8uP.js";import{t as B}from"./formatter-Cd5PYes5.js";import{S as A,a as I}from"./SectionHeader-C4vtWxD-.js";import{S as i}from"./sweetalert2.esm.all-DzlfzZPw.js";const N=$({emits:["closed","refresh"],props:{open:{default:!1,type:Boolean},location:{default:{},type:Object}},data(){return{user:{}}},methods:{closeModal(){this.$emit("closed")},async updateLocation(){var t,e,r,d,c,m,s;await _({connection:"undercater",table:"location",where:[["dataid",(t=this.location)==null?void 0:t.dataid]],columns:[{location:(e=this.location)==null?void 0:e.location},{price:(r=this.location)==null?void 0:r.price},{venue:(d=this.location)==null?void 0:d.venue},{inclusions:(c=this.location)==null?void 0:c.inclusions},{remarks:(m=this.location)==null?void 0:m.remarks},{applied_fee:(s=this.location)==null?void 0:s.applied_fee}]}).then(async v=>{v.success?i.fire({title:"Success",text:"Successfully updated",icon:"success"}).then(async()=>{this.$emit("refresh")}):i.fire({title:"Warning",text:"Fail to update, try again later.",icon:"warning"})})}}}),R={class:"modal-dialog",role:"document"},q={class:"modal-content"},O={class:"modal-body bg-light-gray",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},H={class:"card"},P={class:"card-body"},T={class:"mb-3"},W={class:"row"},j={class:"col-6"},G={class:"mb-3"},z={class:"col-6"},X={class:"mb-3"},Y={class:"mb-3"},Z={class:"mb-3"},J={class:"mb-3"},K={class:"modal-footer"};function Q(t,e,r,d,c,m){return p(),u("div",{class:C(["modal fade",{show:t.open,display:t.open}]),tabindex:"-1",role:"dialog"},[o("div",R,[o("div",q,[e[14]||(e[14]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Edit Location")],-1)),o("div",O,[o("div",H,[o("div",P,[o("div",T,[e[8]||(e[8]=o("label",{class:"form-label"},"Location",-1)),l(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.location.location=s),type:"text",class:"form-control"},null,512),[[a,t.location.location]])]),o("div",W,[o("div",j,[o("div",G,[e[9]||(e[9]=o("label",{class:"form-label"},"Price",-1)),l(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.location.price=s),type:"number",class:"form-control"},null,512),[[a,t.location.price]])])]),o("div",z,[o("div",X,[e[10]||(e[10]=o("label",{class:"form-label"},"Add-on Fee",-1)),l(o("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>t.location.applied_fee=s),type:"number",class:"form-control"},null,512),[[a,t.location.applied_fee]])])])]),o("div",Y,[e[11]||(e[11]=o("label",{class:"form-label"},"Notice",-1)),l(o("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>t.location.venue=s),type:"text",class:"form-control"},null,512),[[a,t.location.venue]])]),o("div",Z,[e[12]||(e[12]=o("label",{class:"form-label"},"Inclusion",-1)),l(o("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>t.location.inclusions=s),class:"form-control"},null,512),[[a,t.location.inclusions]])]),o("div",J,[e[13]||(e[13]=o("label",{class:"form-label"},"Remarks",-1)),l(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>t.location.remarks=s),class:"form-control"},null,512),[[a,t.location.remarks]])])])])]),o("div",K,[o("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>t.closeModal())},"Close"),o("button",{type:"button",class:"btn btn-primary w-25",onClick:e[7]||(e[7]=s=>t.updateLocation())},"Update")])])])],2)}const x=h(N,[["render",Q],["__scopeId","data-v-4b3bc5d4"]]),oo=$({emits:["closed","refresh"],props:{open:{default:!1,type:Boolean}},data(){return{user:{},form:{location:"",price:0,venue:"",inclusions:"",remarks:"",applied_fee:0}}},methods:{closeModal(){this.$emit("closed")},async onCreateLocation(){await S({connection:"undercater",table:"location",columns:this.form}).then(async t=>{t.success?i.fire({title:"Success",text:"Successfully created",icon:"success"}).then(async()=>{this.$emit("refresh")}):i.fire({title:"Warning",text:"Fail to create, try again later.",icon:"warning"})})}}}),eo={class:"modal-dialog",role:"document"},to={class:"modal-content"},so={class:"modal-body bg-light-gray",style:{"max-height":"calc(100vh - 300px)",overflow:"auto"}},no={class:"card"},lo={class:"card-body"},ao={class:"mb-3"},io={class:"row"},ro={class:"col-6"},co={class:"mb-3"},mo={class:"col-6"},uo={class:"mb-3"},po={class:"mb-3"},fo={class:"mb-3"},bo={class:"mb-3"},yo={class:"modal-footer"};function vo(t,e,r,d,c,m){return p(),u("div",{class:C(["modal fade",{show:t.open,display:t.open}]),tabindex:"-1",role:"dialog"},[o("div",eo,[o("div",to,[e[14]||(e[14]=o("div",{class:"modal-header"},[o("h5",{class:"modal-title"},"Create Location")],-1)),o("div",so,[o("div",no,[o("div",lo,[o("div",ao,[e[8]||(e[8]=o("label",{class:"form-label"},"Location",-1)),l(o("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>t.form.location=s),type:"text",class:"form-control"},null,512),[[a,t.form.location]])]),o("div",io,[o("div",ro,[o("div",co,[e[9]||(e[9]=o("label",{class:"form-label"},"Price",-1)),l(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.form.price=s),type:"number",class:"form-control"},null,512),[[a,t.form.price]])])]),o("div",mo,[o("div",uo,[e[10]||(e[10]=o("label",{class:"form-label"},"Add-on Fee",-1)),l(o("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>t.form.applied_fee=s),type:"number",class:"form-control"},null,512),[[a,t.form.applied_fee]])])])]),o("div",po,[e[11]||(e[11]=o("label",{class:"form-label"},"Notice",-1)),l(o("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>t.form.venue=s),type:"text",class:"form-control"},null,512),[[a,t.form.venue]])]),o("div",fo,[e[12]||(e[12]=o("label",{class:"form-label"},"Inclusion",-1)),l(o("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>t.form.inclusions=s),class:"form-control"},null,512),[[a,t.form.inclusions]])]),o("div",bo,[e[13]||(e[13]=o("label",{class:"form-label"},"Remarks",-1)),l(o("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>t.form.remarks=s),class:"form-control"},null,512),[[a,t.form.remarks]])])])])]),o("div",yo,[o("button",{type:"button",class:"btn btn-secondary",onClick:e[6]||(e[6]=s=>t.closeModal())},"Close"),o("button",{type:"button",class:"btn btn-primary w-25",onClick:e[7]||(e[7]=s=>t.onCreateLocation())},"Create")])])])],2)}const $o=h(oo,[["render",vo],["__scopeId","data-v-1f97844c"]]),ho=$({components:{CreateLocation:$o,EditLocation:x,SectionSidebar:I,SectionHeader:A},data(){return{admin:{},locations:[],modal:{location:{},edit_open:!1,create_open:!1}}},methods:{toCurrencyFormat(t){return B(t)},onCreateLocation(){var t;((t=this.admin)==null?void 0:t.role)==1?this.modal.create_open=!0:i.fire({title:"Action denied",text:"Only administrator level has permission to create new location",icon:"error"})},onEditModal(t){var e;((e=this.admin)==null?void 0:e.role)==1?(this.modal.location=t,this.modal.edit_open=!0):i.fire({title:"Action denied",text:"Only administrator level has permission to edit a location",icon:"error"})},async fetchLocations(){await D({connection:"undercater",table:"location",where:[["dataid",">",0]],orderby:["location","asc"]}).then(async t=>{this.locations=t})},async onDeleteLocation(t){var e;((e=this.admin)==null?void 0:e.role)==1?i.fire({title:"Confirmation",text:"Delete "+(t==null?void 0:t.location)+"?",icon:"question",confirmButtonText:"Delete",confirmButtonColor:"#ff3e1d",showCancelButton:!0}).then(async r=>{r.isConfirmed&&await V({connection:"undercater",table:"location",where:[["dataid",t==null?void 0:t.dataid]]}).then(async d=>{d.success?i.fire({title:"Deleted",text:"Successfully deleted",icon:"success"}).then(async()=>{await this.fetchLocations()}):i.fire({title:"Warning",text:"Fail to delete, try again later.",icon:"warning"})})}):i.fire({title:"Action denied",text:"Only administrator level has permission to delete a location",icon:"error"})}},async mounted(){await U().then(async t=>{t?(this.admin=t,this.fetchLocations()):this.$router.replace("/")})}}),wo={class:"layout-wrapper layout-content-navbar"},Co={class:"layout-container"},go={class:"layout-page"},Lo={class:"content-wrapper"},ko={class:"container-xxl flex-grow-1 container-p-y"},_o={class:"d-flex justify-content-between align-items-center"},So={class:"card"},Uo={class:"table-responsive text-nowrap"},Vo={class:"table"},Do={class:"table-border-bottom-0"},Eo={class:"text-wrap"},Fo=["onClick"],Mo=["onClick"];function Bo(t,e,r,d,c,m){const s=b("SectionSidebar"),v=b("SectionHeader"),g=b("EditLocation"),L=b("CreateLocation");return p(),u("div",wo,[o("div",Co,[f(s),o("div",go,[f(v,{onOpen_notif:e[0]||(e[0]=()=>{t.$emit("open_notif")})}),o("div",Lo,[o("div",ko,[o("div",_o,[e[4]||(e[4]=o("h4",{class:"fw-bold py-3 mb-4"},[o("span",{class:"text-muted fw-light"},"Locations /"),E(" Masterlist")],-1)),o("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=n=>t.onCreateLocation())},"New Location")]),o("div",So,[o("div",Uo,[o("table",Vo,[e[5]||(e[5]=o("thead",null,[o("tr",null,[o("th",null,"No."),o("th",null,"Location"),o("th",null,"Price"),o("th",null,"Remarks"),o("th",{style:{width:"80px"}},"Edit"),o("th",{style:{width:"100px"}},"Delete")])],-1)),o("tbody",Do,[(p(!0),u(F,null,M(t.locations,(n,w)=>(p(),u("tr",{key:w},[o("td",null,y(w+1),1),o("td",null,y(n==null?void 0:n.location),1),o("td",null,y(t.toCurrencyFormat(n==null?void 0:n.price)),1),o("td",Eo,y(n==null?void 0:n.remarks),1),o("td",null,[o("button",{class:"btn btn-primary btn-sm",onClick:k=>t.onEditModal(n)},"Edit",8,Fo)]),o("td",null,[o("button",{class:"btn btn-danger btn-sm",onClick:k=>t.onDeleteLocation(n)},"Delete",8,Mo)])]))),128))])])])])])])])]),f(g,{location:t.modal.location,open:t.modal.edit_open,onClosed:e[2]||(e[2]=()=>{t.modal.edit_open=!1}),onRefresh:t.fetchLocations},null,8,["location","open","onRefresh"]),f(L,{open:t.modal.create_open,onClosed:e[3]||(e[3]=()=>{t.modal.create_open=!1}),onRefresh:t.fetchLocations},null,8,["open","onRefresh"])])}const qo=h(ho,[["render",Bo]]);export{qo as default};
