import{_ as A,d as E,l as S,c as g,S as I,b as T}from"./SectionFooter-p82ZZrBf.js";import{S as P}from"./SectionBanner-AYBWTdjs.js";import{m as D}from"./homelogo-CawgJVMl.js";import{d as C,c,a as t,t as r,o as m,g as w,v as $,n as j,i as M,f as y,r as b,F,j as O}from"./index-cvgqalPm.js";import{a as k,v as _}from"./index-voVhswPz.js";import{$ as B}from"./jquery-DvzhgAK6.js";const V=C({name:"CardEvent",emits:["openModal"],props:{event:{default:{},type:Object}},setup(a,{emit:e}){return{openModal:d=>{e("openModal",{data:d})},eventImage:D}}}),H={class:"card event-card border-0 m-4"},U=["src"],L={class:"card-body p-4 mt-4"},N={class:"d-flex justify-content-between align-items-center pb-4"},Y={key:0},q={key:1},W={class:"table"};function z(a,e,i,l,d,p){var n,o,v,u,f,s,h;return m(),c("div",H,[t("img",{class:"w-100",src:a.eventImage,alt:"Event Image"},null,8,U),t("div",L,[t("div",N,[t("h1",null,r((n=a.event)==null?void 0:n.name),1),t("button",{class:"btn btn-select",onClick:e[0]||(e[0]=bt=>a.openModal(a.event))},"Select Event")]),((v=(o=a.event)==null?void 0:o.name)==null?void 0:v.trim().toLowerCase())==="baptism"?(m(),c("p",Y," A baptism is a sacred Christian ceremony where a child or adult is welcomed into the faith. The event usually includes prayers, blessings, and a small celebration with family and friends. ")):(m(),c("p",q,r((u=a.event)==null?void 0:u.description),1)),t("table",W,[t("tbody",null,[t("tr",null,[e[1]||(e[1]=t("td",null,"Min capacity",-1)),t("td",null,r((f=a.event)==null?void 0:f.min_occupancy),1)]),t("tr",null,[e[2]||(e[2]=t("td",null,"Max capacity",-1)),t("td",null,r((s=a.event)==null?void 0:s.max_occupancy),1)]),t("tr",null,[e[3]||(e[3]=t("td",null,"Price per pack",-1)),t("td",null,"PHP "+r((h=a.event)==null?void 0:h.price),1)])])])])])}const J=A(V,[["render",z],["__scopeId","data-v-99833d72"]]),R=C({name:"ModalEventAvailability",props:{open:{default:!0,type:Boolean},event:{default:{},type:Object}},data(){return{form:{date:"",start_time:"",end_time:""}}},methods:{async closeModal(){this.$emit("closed")},async checkAvailability(){await k.get(_().api_main+"events/checkAvailability?"+B.param(this.form)).then(async a=>{var e,i;console.log(a.data),(e=a.data)!=null&&e.success?g.fire({title:"Available",text:"Your selected date and time is available, would you like to proceed in booking process?",icon:"question",showCancelButton:!0,cancelButtonText:"Maybe later",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Proceed to Booking"}).then(async l=>{l.isConfirmed&&await this.proceedToBooking()}):g.fire({title:"Warning",text:(i=a.data)==null?void 0:i.message,icon:"warning"})})},async proceedToBooking(){await E().then(async a=>{var i,l;if(a){var e={user_dataid:a==null?void 0:a.dataid,pax_price:(i=this.event)==null?void 0:i.price,event_dataid:(l=this.event)==null?void 0:l.dataid,event_date:this.form.date,event_start_time:this.form.start_time,event_end_time:this.form.end_time};await k.get(_().api_main+"booking/initBooking?"+B.param(e)).then(async d=>{var p,n,o;(p=d.data)!=null&&p.success?(S.set("booking-event",this.event),S.set("booking-dataid",(n=d.data)==null?void 0:n.last_dataid),this.$router.replace("/events-booking")):g.fire({title:"Warning",text:(o=d.data)==null?void 0:o.message,icon:"warning"})})}else g.fire({title:"Sign In required",text:"Please sign in or create account to continue",icon:"warning"})})}}}),G="/assets/people-CSY6Sioh.jfif",K={class:"modal-dialog modal-lg",role:"document"},Q={class:"modal-content"},X={class:"modal-body"},Z={class:"row"},x={class:"col-sm-12 col-md-7"},tt={key:0,class:"baptism-description"},et={key:1,class:"default-description"},at={class:"table"},nt={class:"col-sm-12 col-md-5"},ot={class:"availability-card p-4 rounded"},it={class:"mb-3"},st={class:"mb-3"},lt={class:"mb-3"},dt={class:"modal-footer"};function rt(a,e,i,l,d,p){var n,o,v,u,f;return m(),c("div",{class:j(["modal fade",{show:a.open,display:a.open}]),tabindex:"-1",role:"dialog"},[t("div",K,[t("div",Q,[e[14]||(e[14]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Check Availability")],-1)),t("div",X,[t("div",Z,[t("div",x,[e[8]||(e[8]=t("img",{class:"w-100",src:G},null,-1)),t("h1",null,r((n=a.event)==null?void 0:n.name),1),((o=a.event)==null?void 0:o.name)==="Baptism"?(m(),c("p",tt," Baptism is a sacred Christian ceremony where a child or adult is welcomed into the faith. The event usually includes prayers, blessings, and a small celebration with family and friends. ")):(m(),c("p",et," This is a wonderful event where everyone is welcome to join and celebrate the special occasion. ")),t("table",at,[t("tbody",null,[t("tr",null,[e[5]||(e[5]=t("td",null,"Min capacity",-1)),t("td",null,r((v=a.event)==null?void 0:v.min_occupancy),1)]),t("tr",null,[e[6]||(e[6]=t("td",null,"Max capacity",-1)),t("td",null,r((u=a.event)==null?void 0:u.max_occupancy),1)]),t("tr",null,[e[7]||(e[7]=t("td",null,"Price per pack",-1)),t("td",null,"PHP "+r((f=a.event)==null?void 0:f.price),1)])])])]),t("div",nt,[t("div",ot,[e[12]||(e[12]=t("h2",{class:"mb-4 text-dark"},"Enter date and time to verify availability",-1)),t("div",it,[e[9]||(e[9]=t("label",{class:"form-label text-dark"},"Date of Visit",-1)),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.form.date=s),type:"date",class:"form-control form-control-lg"},null,512),[[$,a.form.date]])]),t("div",st,[e[10]||(e[10]=t("label",{class:"form-label text-dark"},"Select Start Time",-1)),w(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.form.start_time=s),type:"time",class:"form-control form-control-lg"},null,512),[[$,a.form.start_time]])]),t("div",lt,[e[11]||(e[11]=t("label",{class:"form-label text-dark"},"Select End Time",-1)),w(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.form.end_time=s),type:"time",class:"form-control form-control-lg"},null,512),[[$,a.form.end_time]])]),t("button",{class:"btn btn-check-availability btn-lg w-100 mt-3",onClick:e[3]||(e[3]=s=>a.checkAvailability())},"Check Availability")])])]),e[13]||(e[13]=t("div",{class:"alert alert-warning mt-4"},[t("p",null,[t("small",null,'"Only 50 pax can be accommodate for a one-day preparation, and no bookings will be accepted for the following day. Any such booking will be automatically cancelled."')])],-1))]),t("div",dt,[t("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",onClick:e[4]||(e[4]=s=>a.closeModal())},"Close")])])])],2)}const ct=A(R,[["render",rt],["__scopeId","data-v-1b4414b6"]]),mt=C({name:"EventsPage",data(){return{user:{},events:[],draft:{},modal:{checkAvailability:!1,checkAvailabilityEvent:{}}}},components:{ModalEventAvailability:ct,CardEvent:J,SectionBanner:P,SectionFooter:T,SectionHeader:I},methods:{async fetchAll(){await k.get(_().api_main+"events/fetchAll").then(async a=>{this.events=a.data})},async openModalAvailChecker(a){this.modal.checkAvailability=!0,this.modal.checkAvailabilityEvent=a==null?void 0:a.data},async fetchDraft(){var a;await k.get(_().api_main+"booking/getDraft/"+((a=this.user)==null?void 0:a.dataid)).then(async e=>{var i,l,d,p,n,o;this.draft=e.data,(i=e.data)!=null&&i.success&&(localStorage.setItem("booking-dataid",(p=(d=(l=e.data)==null?void 0:l.data)==null?void 0:d.header)==null?void 0:p.dataid),localStorage.setItem("booking-event",JSON.stringify((o=(n=e.data)==null?void 0:n.data)==null?void 0:o.event)),this.$router.push("/events-booking"))})}},async mounted(){await E().then(async a=>{a?(this.user=a,await this.fetchAll().then(async()=>{await this.fetchDraft().then(async()=>{console.log("Data:",M(this.$data))})})):await this.fetchAll().then(async()=>{console.log("Data:",M(this.$data))})})}}),pt={class:"main"},vt={class:"content"},ut={class:"container py-5"},ft={class:"row"};function yt(a,e,i,l,d,p){const n=b("SectionHeader"),o=b("SectionBanner"),v=b("CardEvent"),u=b("SectionFooter"),f=b("ModalEventAvailability");return m(),c("div",null,[y(n),t("main",pt,[t("div",vt,[y(o,{title:"Booking",description:"Come for the Food, stay for the memories"}),t("div",ut,[t("div",ft,[(m(!0),c(F,null,O(a.events,(s,h)=>(m(),c("div",{class:"col-sm-12 col-lg-6",key:h},[y(v,{event:s,onOpenModal:a.openModalAvailChecker},null,8,["event","onOpenModal"])]))),128))])])]),y(u)]),y(f,{event:a.modal.checkAvailabilityEvent,open:a.modal.checkAvailability,onClosed:e[0]||(e[0]=()=>{a.modal.checkAvailability=!1})},null,8,["event","open"])])}const At=A(mt,[["render",yt],["__scopeId","data-v-f0566cb6"]]);export{At as default};
